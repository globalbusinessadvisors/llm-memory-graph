# LLM-Memory-Graph Architecture Diagrams

## Visual Architecture Reference

This document contains ASCII-based architecture diagrams for the LLM-Memory-Graph integration ecosystem.

---

## 1. SYSTEM CONTEXT DIAGRAM

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        LLM DEVOPS ECOSYSTEM                                 │
│                                                                             │
│  ┌─────────────────┐         ┌──────────────────┐       ┌────────────────┐ │
│  │                 │         │                  │       │                │ │
│  │ LLM-Observatory │────────>│ LLM-Memory-Graph │<──────│  LLM-Registry  │ │
│  │  (Telemetry)    │  Events │  (Graph Store)   │ Sync  │  (Metadata)    │ │
│  │                 │         │                  │       │                │ │
│  └─────────────────┘         └────────┬─────────┘       └────────────────┘ │
│                                       │                                     │
│                                       │ Secure                              │
│                                       │ Storage                             │
│                                       ▼                                     │
│                              ┌─────────────────┐                            │
│                              │                 │                            │
│                              │ LLM-Data-Vault  │                            │
│                              │ (Encryption)    │                            │
│                              │                 │                            │
│                              └─────────────────┘                            │
│                                                                             │
│  External Dependencies:                                                     │
│  ┌─────────┐  ┌─────────┐  ┌──────────┐  ┌─────────┐                      │
│  │ Kafka   │  │ Neo4j   │  │ AWS KMS  │  │ OAuth2  │                      │
│  └─────────┘  └─────────┘  └──────────┘  └─────────┘                      │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. DETAILED COMPONENT ARCHITECTURE

```
┌───────────────────────────────────────────────────────────────────────────────┐
│                          LLM-MEMORY-GRAPH INTERNALS                           │
├───────────────────────────────────────────────────────────────────────────────┤
│                                                                               │
│  ┌─────────────────────────────────────────────────────────────────────┐     │
│  │                        API GATEWAY LAYER                            │     │
│  │  ┌──────────┐  ┌──────────┐  ┌───────────┐  ┌──────────────┐      │     │
│  │  │ REST API │  │ gRPC API │  │ GraphQL   │  │ WebSocket    │      │     │
│  │  │ :8080    │  │ :50051   │  │ :8081     │  │ (Real-time)  │      │     │
│  │  └────┬─────┘  └────┬─────┘  └─────┬─────┘  └──────┬───────┘      │     │
│  │       │             │              │               │               │     │
│  │       └─────────────┴──────────────┴───────────────┘               │     │
│  │                            │                                        │     │
│  │                    ┌───────▼───────┐                               │     │
│  │                    │ Auth Middleware│                               │     │
│  │                    │ Rate Limiting  │                               │     │
│  │                    │ Request Valid. │                               │     │
│  │                    └───────┬────────┘                               │     │
│  └────────────────────────────┼───────────────────────────────────────┘     │
│                               │                                              │
│  ┌────────────────────────────┼───────────────────────────────────────┐     │
│  │                    BUSINESS LOGIC LAYER                            │     │
│  │                            │                                        │     │
│  │  ┌─────────────────────────▼─────────────────────────────┐         │     │
│  │  │           INTEGRATION COORDINATORS                    │         │     │
│  │  │                                                        │         │     │
│  │  │  ┌─────────────────┐  ┌──────────────┐  ┌─────────┐  │         │     │
│  │  │  │  Observatory    │  │   Registry   │  │  Vault  │  │         │     │
│  │  │  │   Consumer      │  │   Sync Svc   │  │ Client  │  │         │     │
│  │  │  │                 │  │              │  │         │  │         │     │
│  │  │  │ ┌─────────────┐ │  │ ┌──────────┐ │  │ ┌─────┐ │  │         │     │
│  │  │  │ │ Ring Buffer │ │  │ │ CDC      │ │  │ │ KMS │ │  │         │     │
│  │  │  │ │ Backpressure│ │  │ │ Handler  │ │  │ │ Mgr │ │  │         │     │
│  │  │  │ └─────────────┘ │  │ └──────────┘ │  │ └─────┘ │  │         │     │
│  │  │  │                 │  │              │  │         │  │         │     │
│  │  │  │ ┌─────────────┐ │  │ ┌──────────┐ │  │ ┌─────┐ │  │         │     │
│  │  │  │ │ Circuit     │ │  │ │ Conflict │ │  │ │ Enc │ │  │         │     │
│  │  │  │ │ Breaker     │ │  │ │ Resolver │ │  │ │ Mgr │ │  │         │     │
│  │  │  │ └─────────────┘ │  │ └──────────┘ │  │ └─────┘ │  │         │     │
│  │  │  └────────┬────────┘  └──────┬───────┘  └────┬────┘  │         │     │
│  │  │           │                   │               │       │         │     │
│  │  └───────────┼───────────────────┼───────────────┼───────┘         │     │
│  │              │                   │               │                 │     │
│  │  ┌───────────▼───────────────────▼───────────────▼───────┐         │     │
│  │  │              GRAPH OPERATIONS ENGINE                  │         │     │
│  │  │                                                        │         │     │
│  │  │  ┌────────────┐  ┌─────────────┐  ┌──────────────┐   │         │     │
│  │  │  │ Node       │  │ Relationship│  │ Query        │   │         │     │
│  │  │  │ Builder    │  │ Manager     │  │ Optimizer    │   │         │     │
│  │  │  └────────────┘  └─────────────┘  └──────────────┘   │         │     │
│  │  │                                                        │         │     │
│  │  │  ┌────────────┐  ┌─────────────┐  ┌──────────────┐   │         │     │
│  │  │  │ Batch      │  │ Transaction │  │ Cache        │   │         │     │
│  │  │  │ Writer     │  │ Manager     │  │ Manager      │   │         │     │
│  │  │  └────────────┘  └─────────────┘  └──────────────┘   │         │     │
│  │  └────────────────────────┬───────────────────────────────┘         │     │
│  └───────────────────────────┼───────────────────────────────────────┘     │
│                              │                                              │
│  ┌───────────────────────────▼───────────────────────────────────────┐     │
│  │                    DATA ACCESS LAYER                              │     │
│  │                                                                    │     │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────┐    │     │
│  │  │ Neo4j Driver │  │ Connection   │  │ Query Result         │    │     │
│  │  │              │  │ Pool Manager │  │ Mapper               │    │     │
│  │  └──────┬───────┘  └──────┬───────┘  └──────────────────────┘    │     │
│  │         │                 │                                       │     │
│  └─────────┼─────────────────┼───────────────────────────────────────┘     │
│            │                 │                                              │
│  ┌─────────▼─────────────────▼───────────────────────────────────────┐     │
│  │                 OBSERVABILITY LAYER                               │     │
│  │                                                                    │     │
│  │  ┌────────────┐  ┌──────────────┐  ┌──────────────────────┐      │     │
│  │  │ Prometheus │  │ OpenTelemetry│  │ Structured Logging   │      │     │
│  │  │ Metrics    │  │ Tracing      │  │ (JSON)               │      │     │
│  │  └────────────┘  └──────────────┘  └──────────────────────┘      │     │
│  └────────────────────────────────────────────────────────────────────┘     │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. DATA FLOW DIAGRAM - OBSERVATORY INTEGRATION

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    EVENT INGESTION PIPELINE                                 │
└─────────────────────────────────────────────────────────────────────────────┘

  LLM Observatory
        │
        │ 1. Emit Event
        │    (gRPC Stream)
        ▼
  ┌─────────────┐
  │   Kafka     │
  │   Topic:    │
  │   llm-      │
  │   telemetry │
  └──────┬──────┘
         │
         │ 2. Consume
         │    (Consumer Group)
         ▼
  ┌─────────────────────┐
  │  Memory-Graph       │
  │  Kafka Consumer     │
  │                     │
  │  ┌───────────────┐  │
  │  │ Ring Buffer   │  │ 3. Buffer Events
  │  │ (256 MB)      │  │    (Backpressure)
  │  └───────┬───────┘  │
  │          │          │
  │  ┌───────▼───────┐  │
  │  │ Validator     │  │ 4. Validate Schema
  │  └───────┬───────┘  │
  │          │          │
  │  ┌───────▼───────┐  │
  │  │ Enricher      │  │ 5. Enrich with
  │  │               │  │    Metadata
  │  └───────┬───────┘  │
  │          │          │
  │  ┌───────▼───────┐  │
  │  │ Batch         │  │ 6. Batch (1000/batch)
  │  │ Assembler     │  │
  │  └───────┬───────┘  │
  └──────────┼──────────┘
             │
             │ 7. Write Batch
             ▼
      ┌──────────────┐
      │ Circuit      │
      │ Breaker      │
      └──────┬───────┘
             │
             │ 8. Execute
             ▼
      ┌──────────────────┐
      │   Neo4j Cluster  │
      │                  │
      │  ┌────────────┐  │
      │  │ Invocation │  │ 9. Create Nodes
      │  │ Nodes      │  │
      │  └────────────┘  │
      │                  │
      │  ┌────────────┐  │
      │  │Relationships│ │ 10. Create Edges
      │  └────────────┘  │
      └──────────────────┘
             │
             │ 11. Acknowledge
             ▼
      ┌──────────────────┐
      │  Kafka Consumer  │
      │  Commit Offset   │
      └──────────────────┘

  Error Handling:

  ┌──────────────┐
  │ Failure      │
  └──────┬───────┘
         │
         │ Retry (Exponential Backoff)
         ▼
  ┌──────────────┐     Max Retries
  │ Dead Letter  │◄────Exceeded
  │ Queue (DLQ)  │
  └──────────────┘
```

---

## 4. DATA FLOW DIAGRAM - REGISTRY INTEGRATION

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                   METADATA SYNCHRONIZATION PIPELINE                         │
└─────────────────────────────────────────────────────────────────────────────┘

  LLM Registry
  Database (PostgreSQL)
        │
        │ INSERT/UPDATE/DELETE
        ▼
  ┌─────────────────┐
  │ Debezium CDC    │ 1. Capture Changes
  │ Connector       │    (WAL Reader)
  └────────┬────────┘
           │
           │ 2. Publish to Kafka
           ▼
  ┌─────────────────┐
  │ Kafka Topic:    │
  │ registry.public │
  │ .models         │
  └────────┬────────┘
           │
           │ 3. Consume
           ▼
  ┌─────────────────────────┐
  │ Memory-Graph            │
  │ CDC Consumer            │
  │                         │
  │ ┌─────────────────────┐ │
  │ │ Change Detector     │ │ 4. Parse CDC Event
  │ └──────────┬──────────┘ │
  │            │             │
  │ ┌──────────▼──────────┐ │
  │ │ Model Fetcher       │ │ 5. Fetch Full Model
  │ │ (GraphQL Client)    │◄┼─────────┐
  │ └──────────┬──────────┘ │         │
  │            │             │         │ GraphQL Query
  │ ┌──────────▼──────────┐ │         │
  │ │ Conflict Detector   │ │ 6. Check Conflicts │
  │ └──────────┬──────────┘ │         │
  │            │             │         │
  │ ┌──────────▼──────────┐ │         │
  │ │ Merge Strategy      │ │ 7. Resolve     │
  │ │ - Latest Wins       │ │         │
  │ │ - Union Merge       │ │         │
  │ │ - Append Only       │ │         │
  │ └──────────┬──────────┘ │         │
  └────────────┼─────────────┘         │
               │                       │
               │ 8. Apply Changes      │
               ▼                       │
        ┌──────────────┐               │
        │ Neo4j        │               │
        │              │               │
        │ MERGE Model  │               │
        │ SET metadata │               │
        │ CREATE       │               │
        │ VERSION      │               │
        └──────┬───────┘               │
               │                       │
               │ 9. Usage Stats        │
               │    (Bi-directional)   │
               ▼                       │
        ┌──────────────┐               │
        │ Analytics    │               │
        │ Aggregator   │               │
        └──────┬───────┘               │
               │                       │
               │ 10. POST Stats        │
               ▼                       │
        ┌──────────────┐               │
        │ LLM Registry │◄──────────────┘
        │ API          │
        └──────────────┘

  Real-time Subscription Path:

  ┌──────────────┐         ┌──────────────┐
  │ LLM Registry │ GraphQL │ Memory-Graph │
  │ GraphQL      │◄────────│ Subscription │
  │ Subscription │ WebSocket│ Client      │
  └──────────────┘         └──────────────┘
```

---

## 5. DATA FLOW DIAGRAM - VAULT INTEGRATION

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    SECURE STORAGE PIPELINE                                  │
└─────────────────────────────────────────────────────────────────────────────┘

  STORAGE FLOW:

  Memory-Graph API
        │
        │ 1. Store Request
        │    (Prompt Content)
        ▼
  ┌─────────────────────┐
  │ Data Classification │ 2. Classify
  │ Engine              │    (PII, Confidential, etc.)
  └──────────┬──────────┘
             │
             │ 3. Classify as "confidential"
             ▼
  ┌─────────────────────────┐
  │ Encryption Service      │
  │                         │
  │ ┌─────────────────────┐ │
  │ │ Generate DEK        │ │ 4. Create AES-256 key
  │ │ (32 bytes random)   │ │
  │ └──────────┬──────────┘ │
  │            │             │
  │ ┌──────────▼──────────┐ │
  │ │ Encrypt Content     │ │ 5. AES-256-GCM
  │ │ with DEK            │ │
  │ └──────────┬──────────┘ │
  │            │             │
  │            │             │
  │ ┌──────────▼──────────┐ │    ┌──────────────┐
  │ │ Fetch KEK from KMS  │─┼───>│  AWS KMS     │ 6. Get KEK
  │ └──────────┬──────────┘ │    └──────────────┘
  │            │             │
  │ ┌──────────▼──────────┐ │
  │ │ Encrypt DEK         │ │ 7. Envelope Encryption
  │ │ with KEK            │ │
  │ └──────────┬──────────┘ │
  └────────────┼─────────────┘
               │
               │ 8. Send to Vault
               │    (mTLS)
               ▼
  ┌─────────────────────────┐
  │ LLM Data Vault API      │
  │                         │
  │ ┌─────────────────────┐ │
  │ │ Access Control      │ │ 9. Check RBAC/ABAC
  │ │ Middleware          │ │
  │ └──────────┬──────────┘ │
  │            │             │
  │ ┌──────────▼──────────┐ │
  │ │ Audit Logger        │ │ 10. Create Audit Entry
  │ └──────────┬──────────┘ │
  │            │             │
  │ ┌──────────▼──────────┐ │
  │ │ Storage Engine      │ │ 11. Store Encrypted
  │ │                     │ │     Content + DEK
  │ │ {                  │ │
  │ │   encrypted_content │ │
  │ │   encrypted_dek     │ │
  │ │   iv, auth_tag      │ │
  │ │   metadata          │ │
  │ │ }                  │ │
  │ └──────────┬──────────┘ │
  └────────────┼─────────────┘
               │
               │ 12. Return vault://ref
               ▼
  ┌─────────────────────────┐
  │ Memory-Graph            │
  │ Graph Database          │
  │                         │
  │ CREATE (p:Prompt {     │
  │   id: "prompt-123"     │
  │   content_ref:         │ 13. Store Reference Only
  │     "vault://.../"     │     (NOT actual content)
  │   classification:      │
  │     "confidential"     │
  │ })                     │
  └─────────────────────────┘

  RETRIEVAL FLOW:

  Client Request
        │
        │ 1. GET /prompts/prompt-123
        ▼
  ┌─────────────────────┐
  │ Memory-Graph API    │
  │                     │
  │ MATCH (p:Prompt    │ 2. Query Graph
  │   {id: $id})       │    (Get vault ref)
  │ RETURN p.content_ref│
  └──────────┬──────────┘
             │
             │ 3. vault://confidential/prompts/prompt-123
             ▼
  ┌─────────────────────────┐
  │ Vault Client            │
  │                         │
  │ GET /retrieve/prompt-123│ 4. Request from Vault
  │                         │    (with audit reason)
  └──────────┬──────────────┘
             │
             │ 5. Retrieve
             ▼
  ┌─────────────────────────┐
  │ LLM Data Vault          │
  │                         │
  │ ┌─────────────────────┐ │
  │ │ Access Control      │ │ 6. Verify Access
  │ │ Check               │ │
  │ └──────────┬──────────┘ │
  │            │             │
  │ ┌──────────▼──────────┐ │
  │ │ Audit Logger        │ │ 7. Log Access
  │ └──────────┬──────────┘ │
  │            │             │
  │ ┌──────────▼──────────┐ │
  │ │ Fetch Encrypted     │ │ 8. Get Encrypted Data
  │ │ Content + DEK       │ │
  │ └──────────┬──────────┘ │
  └────────────┼─────────────┘
               │
               │ 9. Return to Client
               ▼
  ┌─────────────────────────┐
  │ Encryption Service      │
  │                         │
  │ ┌─────────────────────┐ │    ┌──────────────┐
  │ │ Decrypt DEK         │─┼───>│  AWS KMS     │ 10. Decrypt DEK
  │ │ with KEK            │ │    └──────────────┘     with KEK
  │ └──────────┬──────────┘ │
  │            │             │
  │ ┌──────────▼──────────┐ │
  │ │ Decrypt Content     │ │ 11. Decrypt Content
  │ │ with DEK            │ │     with DEK
  │ └──────────┬──────────┘ │
  └────────────┼─────────────┘
               │
               │ 12. Return Plaintext
               ▼
  ┌─────────────────────────┐
  │ Client                  │
  │ (Plaintext Content)     │
  └─────────────────────────┘
```

---

## 6. DEPLOYMENT ARCHITECTURE (KUBERNETES)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          KUBERNETES CLUSTER                                 │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                    NAMESPACE: llm-platform                            │  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐ │  │
│  │  │  INGRESS CONTROLLER (Nginx / Istio)                            │ │  │
│  │  │  ┌──────────┐  ┌──────────┐  ┌──────────┐                      │ │  │
│  │  │  │ TLS Term │  │ Rate     │  │ Auth     │                      │ │  │
│  │  │  │          │  │ Limiting │  │ (OAuth2) │                      │ │  │
│  │  │  └────┬─────┘  └────┬─────┘  └────┬─────┘                      │ │  │
│  │  └───────┼─────────────┼─────────────┼────────────────────────────┘ │  │
│  │          │             │             │                              │  │
│  │  ┌───────▼─────────────▼─────────────▼────────────────────────────┐ │  │
│  │  │  MEMORY-GRAPH DEPLOYMENT (Replicas: 3, Autoscale: 3-10)       │ │  │
│  │  │                                                                │ │  │
│  │  │  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────┐ │ │  │
│  │  │  │ Pod-1            │  │ Pod-2            │  │ Pod-3        │ │ │  │
│  │  │  │ ┌──────────────┐ │  │ ┌──────────────┐ │  │ ┌──────────┐ │ │ │  │
│  │  │  │ │ Container    │ │  │ │ Container    │ │  │ │Container │ │ │ │  │
│  │  │  │ │              │ │  │ │              │ │  │ │          │ │ │ │  │
│  │  │  │ │ API Server   │ │  │ │ API Server   │ │  │ │API Server│ │ │ │  │
│  │  │  │ │ :8080/:50051 │ │  │ │ :8080/:50051 │ │  │ │:8080     │ │ │ │  │
│  │  │  │ └──────┬───────┘ │  │ └──────┬───────┘ │  │ └────┬─────┘ │ │ │  │
│  │  │  │        │          │  │        │          │  │      │       │ │ │  │
│  │  │  │ ┌──────▼───────┐ │  │ ┌──────▼───────┐ │  │ ┌────▼─────┐ │ │ │  │
│  │  │  │ │ Kafka        │ │  │ │ Kafka        │ │  │ │ Kafka    │ │ │ │  │
│  │  │  │ │ Consumer     │ │  │ │ Consumer     │ │  │ │ Consumer │ │ │ │  │
│  │  │  │ └──────────────┘ │  │ └──────────────┘ │  │ └──────────┘ │ │ │  │
│  │  │  │                  │  │                  │  │              │ │ │  │
│  │  │  │ Resources:       │  │ Resources:       │  │ Resources:   │ │ │  │
│  │  │  │ CPU: 1-4 cores   │  │ CPU: 1-4 cores   │  │ CPU: 1-4     │ │ │  │
│  │  │  │ Mem: 2-8 GiB     │  │ Mem: 2-8 GiB     │  │ Mem: 2-8 GiB │ │ │  │
│  │  │  └──────────────────┘  └──────────────────┘  └──────────────┘ │ │  │
│  │  └────────────────────────────────────────────────────────────────┘ │  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐ │  │
│  │  │  NEO4J STATEFULSET (Causal Cluster)                            │ │  │
│  │  │                                                                 │ │  │
│  │  │  ┌────────────┐  ┌────────────┐  ┌────────────┐               │ │  │
│  │  │  │ neo4j-0    │  │ neo4j-1    │  │ neo4j-2    │               │ │  │
│  │  │  │ (Leader)   │  │ (Follower) │  │ (Follower) │               │ │  │
│  │  │  │            │  │            │  │            │               │ │  │
│  │  │  │ PVC: 100Gi │  │ PVC: 100Gi │  │ PVC: 100Gi │               │ │  │
│  │  │  │ SSD        │  │ SSD        │  │ SSD        │               │ │  │
│  │  │  └────────────┘  └────────────┘  └────────────┘               │ │  │
│  │  └─────────────────────────────────────────────────────────────────┘ │  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐ │  │
│  │  │  KAFKA STATEFULSET                                             │ │  │
│  │  │                                                                 │ │  │
│  │  │  ┌────────────┐  ┌────────────┐  ┌────────────┐               │ │  │
│  │  │  │ kafka-0    │  │ kafka-1    │  │ kafka-2    │               │ │  │
│  │  │  │ Broker     │  │ Broker     │  │ Broker     │               │ │  │
│  │  │  │            │  │            │  │            │               │ │  │
│  │  │  │ PVC: 200Gi │  │ PVC: 200Gi │  │ PVC: 200Gi │               │ │  │
│  │  │  └────────────┘  └────────────┘  └────────────┘               │ │  │
│  │  └─────────────────────────────────────────────────────────────────┘ │  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐ │  │
│  │  │  SERVICES                                                       │ │  │
│  │  │                                                                 │ │  │
│  │  │  ┌────────────────┐  ┌──────────────┐  ┌───────────────────┐  │ │  │
│  │  │  │ memory-graph   │  │ neo4j-cluster│  │ kafka-headless    │  │ │  │
│  │  │  │ :8080/:50051   │  │ :7687        │  │ :9092             │  │ │  │
│  │  │  │ (ClusterIP)    │  │ (ClusterIP)  │  │ (Headless)        │  │ │  │
│  │  │  └────────────────┘  └──────────────┘  └───────────────────┘  │ │  │
│  │  └─────────────────────────────────────────────────────────────────┘ │  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐ │  │
│  │  │  CONFIGMAPS & SECRETS                                          │ │  │
│  │  │                                                                 │ │  │
│  │  │  ┌──────────────────────┐  ┌────────────────────────────────┐  │ │  │
│  │  │  │ memory-graph-config  │  │ TLS Certificates               │  │ │  │
│  │  │  │ - Kafka brokers      │  │ - Client cert                  │  │ │  │
│  │  │  │ - Neo4j URI          │  │ - Client key                   │  │ │  │
│  │  │  │ - Feature flags      │  │ - CA cert                      │  │ │  │
│  │  │  └──────────────────────┘  └────────────────────────────────┘  │ │  │
│  │  └─────────────────────────────────────────────────────────────────┘ │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │              NAMESPACE: llm-monitoring                                │  │
│  │                                                                       │  │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────────┐   │  │
│  │  │ Prometheus   │  │ Jaeger       │  │ Elasticsearch (Logs)     │   │  │
│  │  │ (Metrics)    │  │ (Traces)     │  │                          │   │  │
│  │  └──────────────┘  └──────────────┘  └──────────────────────────┘   │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

  EXTERNAL DEPENDENCIES (Outside Cluster):

  ┌──────────────┐  ┌────────────────┐  ┌──────────────────┐
  │ AWS KMS      │  │ LLM-Observatory│  │ LLM-Registry     │
  │ (us-east-1)  │  │ (External)     │  │ (External)       │
  └──────────────┘  └────────────────┘  └──────────────────┘
```

---

## 7. SECURITY ARCHITECTURE

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          SECURITY LAYERS                                    │
└─────────────────────────────────────────────────────────────────────────────┘

  NETWORK SECURITY:

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  Internet                                                               │
  └────────────────────────────────┬────────────────────────────────────────┘
                                   │
                         ┌─────────▼─────────┐
                         │  WAF / DDoS       │
                         │  Protection       │
                         └─────────┬─────────┘
                                   │
                         ┌─────────▼─────────┐
                         │  Load Balancer    │
                         │  (TLS Termination)│
                         └─────────┬─────────┘
                                   │
  ┌────────────────────────────────▼────────────────────────────────────────┐
  │  Kubernetes Cluster                                                     │
  │                                                                         │
  │  ┌────────────────────────────────────────────────────────────────┐    │
  │  │  Network Policies (Zero Trust)                                │    │
  │  │                                                                │    │
  │  │  ┌──────────────┐          ┌──────────────┐                   │    │
  │  │  │ Memory-Graph │  mTLS    │ Neo4j        │                   │    │
  │  │  │ Pods         │◄────────►│ Pods         │                   │    │
  │  │  └──────┬───────┘          └──────────────┘                   │    │
  │  │         │                                                      │    │
  │  │         │ mTLS                                                 │    │
  │  │         ▼                                                      │    │
  │  │  ┌──────────────┐                                              │    │
  │  │  │ Kafka Pods   │                                              │    │
  │  │  │ (SASL_SSL)   │                                              │    │
  │  │  └──────────────┘                                              │    │
  │  │                                                                │    │
  │  │  EGRESS RULES:                                                │    │
  │  │  - Allow: AWS KMS (HTTPS)                                     │    │
  │  │  - Allow: External APIs (HTTPS)                               │    │
  │  │  - Deny: All other egress                                     │    │
  │  └────────────────────────────────────────────────────────────────┘    │
  └─────────────────────────────────────────────────────────────────────────┘

  AUTHENTICATION & AUTHORIZATION:

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  Client Request                                                         │
  └────────────────────────────────┬────────────────────────────────────────┘
                                   │
                         ┌─────────▼─────────┐
                         │ API Gateway       │
                         │                   │
                         │ 1. Extract JWT    │
                         └─────────┬─────────┘
                                   │
                         ┌─────────▼─────────┐
                         │ OAuth2 / JWT      │
                         │ Validation        │
                         │                   │
                         │ - Verify signature│
                         │ - Check expiry    │
                         │ - Validate issuer │
                         └─────────┬─────────┘
                                   │
                         ┌─────────▼─────────┐
                         │ RBAC Check        │
                         │                   │
                         │ User Roles:       │
                         │ - admin           │
                         │ - ml_engineer     │
                         │ - data_scientist  │
                         └─────────┬─────────┘
                                   │
                         ┌─────────▼─────────┐
                         │ ABAC Check        │
                         │                   │
                         │ Conditions:       │
                         │ - Time of day     │
                         │ - Network location│
                         │ - MFA verified    │
                         │ - Clearance level │
                         └─────────┬─────────┘
                                   │
                                   │ GRANTED
                                   ▼
                         ┌─────────────────┐
                         │ Access Resource │
                         └─────────────────┘

  ENCRYPTION ARCHITECTURE:

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  ENCRYPTION IN TRANSIT                                                  │
  │                                                                         │
  │  Client ──TLS 1.3──> API Gateway ──mTLS──> Backend Services           │
  │                                                                         │
  │  ┌──────────────────────────────────────────────────────────────────┐  │
  │  │  Certificate Management (cert-manager)                          │  │
  │  │  - Auto-renewal (Let's Encrypt)                                 │  │
  │  │  - 90-day validity                                              │  │
  │  └──────────────────────────────────────────────────────────────────┘  │
  └─────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  ENCRYPTION AT REST                                                     │
  │                                                                         │
  │  ┌──────────────────────────────────────────────────────────────────┐  │
  │  │  Key Hierarchy                                                   │  │
  │  │                                                                  │  │
  │  │  ┌────────────────┐                                             │  │
  │  │  │ Master Key     │  (AWS KMS)                                  │  │
  │  │  │ (Hardware HSM) │                                             │  │
  │  │  └───────┬────────┘                                             │  │
  │  │          │ Encrypts                                             │  │
  │  │          ▼                                                       │  │
  │  │  ┌────────────────┐                                             │  │
  │  │  │ KEK            │  (Key Encryption Key)                       │  │
  │  │  │ Rotated: 1yr   │                                             │  │
  │  │  └───────┬────────┘                                             │  │
  │  │          │ Encrypts                                             │  │
  │  │          ▼                                                       │  │
  │  │  ┌────────────────┐                                             │  │
  │  │  │ DEK            │  (Data Encryption Key)                      │  │
  │  │  │ Rotated: 30d   │                                             │  │
  │  │  └───────┬────────┘                                             │  │
  │  │          │ Encrypts                                             │  │
  │  │          ▼                                                       │  │
  │  │  ┌────────────────┐                                             │  │
  │  │  │ Per-Record Key │  (Unique per content)                       │  │
  │  │  │ (AES-256-GCM)  │                                             │  │
  │  │  └───────┬────────┘                                             │  │
  │  │          │ Encrypts                                             │  │
  │  │          ▼                                                       │  │
  │  │  ┌────────────────┐                                             │  │
  │  │  │ Content        │                                             │  │
  │  │  │ (Ciphertext)   │                                             │  │
  │  │  └────────────────┘                                             │  │
  │  └──────────────────────────────────────────────────────────────────┘  │
  └─────────────────────────────────────────────────────────────────────────┘
```

---

## 8. MONITORING DASHBOARD LAYOUT

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     LLM-MEMORY-GRAPH OPERATIONS DASHBOARD                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌──────────────────────────────┐  ┌──────────────────────────────┐        │
│  │   OVERALL HEALTH             │  │   INTEGRATION STATUS         │        │
│  │                              │  │                              │        │
│  │   ● System Up: 99.95%        │  │   Observatory: ●  HEALTHY   │        │
│  │   ● Requests/s: 5,243        │  │   Registry:    ●  HEALTHY   │        │
│  │   ● p95 Latency: 180ms       │  │   Vault:       ●  HEALTHY   │        │
│  │   ● Error Rate: 0.08%        │  │                              │        │
│  └──────────────────────────────┘  └──────────────────────────────┘        │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │   KAFKA CONSUMER LAG                                                  │  │
│  │                                                                       │  │
│  │   15000 ┤                                                             │  │
│  │         │                                                             │  │
│  │   10000 ┤                           ╭───╮                             │  │
│  │         │                       ╭───╯   ╰───╮                         │  │
│  │    5000 ┤           ╭───────────╯           ╰───────                 │  │
│  │         │   ╭───────╯                               ╰───              │  │
│  │       0 ┼───╯                                           ╰─────────    │  │
│  │         └────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────      │  │
│  │           00:00 02:00 04:00 06:00 08:00 10:00 12:00 14:00 16:00       │  │
│  │                                                                       │  │
│  │   Current Lag: 3,421 messages (🟢 Normal)                            │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  ┌──────────────────────────────┐  ┌──────────────────────────────┐        │
│  │   EVENT PROCESSING           │  │   GRAPH OPERATIONS           │        │
│  │                              │  │                              │        │
│  │   Total: 1.2M events/day     │  │   Writes/s: 2,145            │        │
│  │   Success: 99.92%            │  │   Reads/s: 8,432             │        │
│  │   Failed: 0.08%              │  │   Avg Write Latency: 45ms    │        │
│  │   DLQ: 960 events            │  │   Avg Read Latency: 12ms     │        │
│  └──────────────────────────────┘  └──────────────────────────────┘        │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │   CIRCUIT BREAKER STATUS                                              │  │
│  │                                                                       │  │
│  │   Observatory Stream:  [============================] CLOSED         │  │
│  │   Registry Sync:       [============================] CLOSED         │  │
│  │   Vault Operations:    [============================] CLOSED         │  │
│  │   Graph Writes:        [============================] CLOSED         │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  ┌──────────────────────────────┐  ┌──────────────────────────────┐        │
│  │   VAULT OPERATIONS           │  │   REGISTRY SYNC              │        │
│  │                              │  │                              │        │
│  │   Encrypt/s: 421             │  │   Models Synced: 1,234       │        │
│  │   Decrypt/s: 892             │  │   Sync Lag: 2.3s             │        │
│  │   Avg Encrypt: 18ms          │  │   Conflicts: 0               │        │
│  │   Avg Decrypt: 21ms          │  │   Last Sync: 5s ago          │        │
│  └──────────────────────────────┘  └──────────────────────────────┘        │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │   RESOURCE UTILIZATION                                                │  │
│  │                                                                       │  │
│  │   CPU:    [████████████████████░░░░░░░░░░] 65%                       │  │
│  │   Memory: [███████████████████████░░░░░░░] 75%                       │  │
│  │   Disk:   [██████████░░░░░░░░░░░░░░░░░░░░] 32%                       │  │
│  │   Network:[█████████████████░░░░░░░░░░░░░] 58%                       │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │   RECENT ALERTS                                                       │  │
│  │                                                                       │  │
│  │   ⚠  WARNING  - High memory usage on neo4j-1 (85%)     [5 min ago]   │  │
│  │   ✓  RESOLVED - Kafka consumer lag spike                [12 min ago] │  │
│  │   ✓  RESOLVED - Circuit breaker opened (Vault)          [1 hour ago] │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  Last Updated: 2025-11-06 20:15:23 UTC                    Auto-refresh: 10s│
└─────────────────────────────────────────────────────────────────────────────┘
```

---

**Document Version:** 1.0
**Last Updated:** 2025-11-06
**Format:** ASCII Diagrams
**Rendering:** Best viewed in monospace font
